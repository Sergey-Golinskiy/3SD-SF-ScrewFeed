# GPIO Pin Configuration for Raspberry Pi 5
# All pins use BCM numbering

# =========================
# XY Table Stepper Motors
# =========================
xy_table:
  x_axis:
    step: 9
    dir: 10
    enable: 11
    endstop: 2
  y_axis:
    step: 21
    dir: 7
    enable: 8
    endstop: 3

# =========================
# Relays (directly connected to Master Pi 5)
# =========================
relays:
  # Screwdriver control
  screwdriver_power:
    gpio: 17
    active_high: true
    description: "Screwdriver motor power"

  screwdriver_direction:
    gpio: 27
    active_high: true
    description: "Screwdriver direction (CW/CCW)"

  # Pneumatics
  cylinder_down:
    gpio: 22
    active_high: true
    description: "Pneumatic cylinder - push down"

  cylinder_up:
    gpio: 23
    active_high: true
    description: "Pneumatic cylinder - retract"

  vacuum:
    gpio: 24
    active_high: true
    description: "Vacuum gripper"

  blow:
    gpio: 25
    active_high: true
    description: "Air blow for cleaning"

# =========================
# Sensors (directly connected to Master Pi 5)
# =========================
sensors:
  # Safety curtain - blocks entry to work area
  # OPEN (HIGH) = clear, no obstruction
  # CLOSE (LOW) = blocked, stop operations
  area_sensor:
    gpio: 17
    active_low: true
    description: "Safety light curtain (AREA_SENSOR)"
    pull_up: true

  # Start pedal - initiates cycle
  # OPEN (HIGH) = released
  # CLOSE (LOW) = pressed
  ped_start:
    gpio: 18
    active_low: true
    description: "Start pedal (PED_START)"
    pull_up: true

  # Cylinder UP position sensor
  # ACTIVE = cylinder is in upper position
  ger_c2_up:
    gpio: 22
    active_low: true
    description: "Cylinder UP position (GER_C2_UP)"
    pull_up: true

  # Cylinder DOWN position sensor - EMERGENCY!
  # If triggered, must turn off R04_C2 (cylinder relay)
  # ACTIVE = cylinder reached bottom (emergency condition)
  ger_c2_down:
    gpio: 23
    active_low: true
    description: "Cylinder DOWN position - EMERGENCY (GER_C2_DOWN)"
    pull_up: true

  # Inductive screw sensor - detects if screw passed through tube
  # OPEN (HIGH) = no screw
  # CLOSE (LOW) = screw passed/present
  ind_scrw:
    gpio: 12
    active_low: true
    description: "Inductive screw sensor (IND_SCRW)"
    pull_up: true

  # Driver torque OK signal
  # OPEN (HIGH) = torque not reached yet
  # CLOSE (LOW) = torque reached, screw tightened
  do2_ok:
    gpio: 25
    active_low: true
    description: "Torque reached signal (DO2_OK)"
    pull_up: true

# =========================
# Communication
# =========================
serial:
  xy_table_port: "/dev/ttyAMA0"
  xy_table_baud: 115200

# =========================
# Logic settings
# =========================
logic:
  endstop_active_low: true
  relay_active_high: true
  step_pulse_active_low: true
  step_idle_level: 1
