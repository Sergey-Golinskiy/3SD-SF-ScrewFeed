<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScrewDrive Control Panel</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <h1>ScrewDrive Control Panel</h1>
            <div class="status-indicator" id="connectionStatus">
                <span class="dot"></span>
                <span class="text">Connecting...</span>
            </div>
        </header>

        <!-- Tab Navigation -->
        <nav class="tabs">
            <button class="tab-btn active" data-tab="status">Status</button>
            <button class="tab-btn" data-tab="control">Control</button>
            <button class="tab-btn" data-tab="xy">XY Table</button>
            <button class="tab-btn" data-tab="settings">Settings</button>
        </nav>

        <!-- Tab Content -->
        <main class="tab-content">
            <!-- Status Tab -->
            <section id="status" class="tab-panel active">
                <div class="grid-2">
                    <!-- Cycle Status -->
                    <div class="card">
                        <h2>Cycle Status</h2>
                        <div class="status-grid">
                            <div class="status-item">
                                <span class="label">State</span>
                                <span class="value" id="cycleState">-</span>
                            </div>
                            <div class="status-item">
                                <span class="label">Device</span>
                                <span class="value" id="currentDevice">-</span>
                            </div>
                            <div class="status-item">
                                <span class="label">Progress</span>
                                <span class="value" id="cycleProgress">0 / 0</span>
                            </div>
                            <div class="status-item">
                                <span class="label">Cycles</span>
                                <span class="value" id="cycleCount">0</span>
                            </div>
                        </div>
                    </div>

                    <!-- XY Table Status -->
                    <div class="card">
                        <h2>XY Table</h2>
                        <div class="status-grid">
                            <div class="status-item">
                                <span class="label">Status</span>
                                <span class="value" id="xyState">-</span>
                            </div>
                            <div class="status-item">
                                <span class="label">Position</span>
                                <span class="value" id="xyPosition">X: 0.00 Y: 0.00</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sensors -->
                <div class="card">
                    <h2>Sensors</h2>
                    <div class="sensor-grid" id="sensorGrid">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- Relays -->
                <div class="card">
                    <h2>Relays</h2>
                    <div class="relay-grid" id="relayGrid">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </section>

            <!-- Control Tab -->
            <section id="control" class="tab-panel">
                <div class="card">
                    <h2>Cycle Control</h2>
                    <div class="control-row">
                        <select id="deviceSelect" class="input-select">
                            <option value="">-- Select Device --</option>
                        </select>
                        <button class="btn btn-primary" id="btnCycleStart">START</button>
                        <button class="btn btn-danger" id="btnCycleStop">STOP</button>
                        <button class="btn btn-warning" id="btnCyclePause">PAUSE</button>
                    </div>
                </div>

                <div class="card">
                    <h2>Emergency</h2>
                    <div class="control-row">
                        <button class="btn btn-danger btn-large" id="btnEstop">E-STOP</button>
                        <button class="btn btn-secondary" id="btnClearEstop">Clear E-STOP</button>
                    </div>
                </div>

                <div class="card">
                    <h2>Relay Manual Control</h2>
                    <div class="relay-control-grid" id="relayControlGrid">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </section>

            <!-- XY Table Tab -->
            <section id="xy" class="tab-panel">
                <div class="grid-2">
                    <div class="card">
                        <h2>Position</h2>
                        <div class="xy-position">
                            <span class="xy-coord" id="xyPosDisplay">X: 0.00  Y: 0.00</span>
                        </div>
                        <div class="xy-status">
                            <span class="label">State:</span>
                            <span class="value" id="xyStateDisplay">-</span>
                        </div>
                    </div>

                    <div class="card">
                        <h2>Jog Control</h2>
                        <div class="jog-grid">
                            <div></div>
                            <button class="btn btn-jog" data-jog="y-">Y-</button>
                            <div></div>
                            <button class="btn btn-jog" data-jog="x-">X-</button>
                            <button class="btn btn-jog btn-home" id="btnXYHome">HOME</button>
                            <button class="btn btn-jog" data-jog="x+">X+</button>
                            <div></div>
                            <button class="btn btn-jog" data-jog="y+">Y+</button>
                            <div></div>
                        </div>
                        <div class="jog-step">
                            <label>Step:</label>
                            <select id="jogStep" class="input-select">
                                <option value="0.1">0.1 mm</option>
                                <option value="0.5">0.5 mm</option>
                                <option value="1">1 mm</option>
                                <option value="5">5 mm</option>
                                <option value="10" selected>10 mm</option>
                                <option value="50">50 mm</option>
                                <option value="100">100 mm</option>
                            </select>
                            <label>Feed:</label>
                            <select id="jogFeed" class="input-select">
                                <option value="1000">1000 mm/min</option>
                                <option value="3000">3000 mm/min</option>
                                <option value="5000" selected>5000 mm/min</option>
                                <option value="10000">10000 mm/min</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2>Move To Position</h2>
                    <div class="move-form">
                        <div class="input-group">
                            <label>X:</label>
                            <input type="number" id="moveX" class="input-number" value="0" step="0.1">
                        </div>
                        <div class="input-group">
                            <label>Y:</label>
                            <input type="number" id="moveY" class="input-number" value="0" step="0.1">
                        </div>
                        <div class="input-group">
                            <label>Feed:</label>
                            <input type="number" id="moveFeed" class="input-number" value="10000">
                        </div>
                        <button class="btn btn-primary" id="btnMoveTo">GO</button>
                    </div>
                </div>

                <div class="card">
                    <h2>Quick Actions</h2>
                    <div class="control-row">
                        <button class="btn btn-secondary" id="btnHomeX">Home X</button>
                        <button class="btn btn-secondary" id="btnHomeY">Home Y</button>
                        <button class="btn btn-secondary" id="btnZero">Go to Zero</button>
                    </div>
                </div>
            </section>

            <!-- Settings Tab -->
            <section id="settings" class="tab-panel">
                <div class="settings-layout">
                    <!-- Left: Device List -->
                    <div class="card settings-devices">
                        <div class="card-header">
                            <h2>Devices</h2>
                            <button class="btn btn-add" id="btnNewDevice">+</button>
                        </div>
                        <div class="device-list" id="deviceList">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <!-- Right: Editor -->
                    <div class="card settings-editor">
                        <h2>Device Editor</h2>

                        <div class="editor-form">
                            <input type="hidden" id="editDeviceKey">

                            <div class="form-row">
                                <div class="form-group">
                                    <label>Name (Key)</label>
                                    <input type="text" id="editName" class="input-text" placeholder="MCO_BACK">
                                </div>
                                <div class="form-group">
                                    <label>Description</label>
                                    <input type="text" id="editWhat" class="input-text" placeholder="What to screw">
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label>Holes Count</label>
                                    <input type="number" id="editHoles" class="input-number" value="0" min="0">
                                </div>
                                <div class="form-group">
                                    <label>Screw Size</label>
                                    <input type="text" id="editScrewSize" class="input-text" placeholder="M3x10">
                                </div>
                                <div class="form-group">
                                    <label>Task Number</label>
                                    <input type="text" id="editTask" class="input-text" placeholder="TASK-001">
                                </div>
                            </div>
                        </div>

                        <!-- Coordinates Section -->
                        <div class="coords-section">
                            <div class="card-header">
                                <h3>Movement Coordinates</h3>
                                <button class="btn btn-add" id="btnAddCoord">+</button>
                            </div>

                            <div class="coords-header">
                                <span class="col-num">#</span>
                                <span class="col-x">X</span>
                                <span class="col-y">Y</span>
                                <span class="col-type">Type</span>
                                <span class="col-feed">Feed</span>
                                <span class="col-action">Go</span>
                                <span class="col-del"></span>
                            </div>

                            <div class="coords-list" id="coordsList">
                                <!-- Populated by JS -->
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="editor-actions">
                            <button class="btn btn-primary" id="btnSaveDevice">Save Device</button>
                            <button class="btn btn-secondary" id="btnCancelEdit">Cancel</button>
                            <button class="btn btn-danger" id="btnDeleteDevice">Delete</button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script src="/static/js/app.js"></script>
</body>
</html>
